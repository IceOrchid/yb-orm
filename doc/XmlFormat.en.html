<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="LibreOffice 3.5  (Linux)">
	<META NAME="AUTHOR" CONTENT="Viacheslav Naydenov">
	<META NAME="CREATED" CONTENT="20130520;10080300">
	<META NAME="CHANGEDBY" CONTENT="Vaclav Naydionov">
	<META NAME="CHANGED" CONTENT="20140529;8163000">
	<META NAME="CHANGEDBY" CONTENT="Vaclav Naydionov">
	<META NAME="CHANGEDBY" CONTENT="Vaclav Naydionov">
	<STYLE TYPE="text/css">
	<!--
		@page { margin: 2cm }
		P { margin-bottom: 0.21cm }
		H2 { margin-bottom: 0.21cm }
		H2.western { font-family: "Times New Roman", serif }
		H2.cjk { font-family: "Droid Sans Fallback" }
		H2.ctl { font-family: "Lohit Hindi" }
		TT.western { font-family: "Droid Sans Mono", monospace }
		TT.cjk { font-family: "Droid Sans Fallback", monospace }
		TT.ctl { font-family: "Lohit Hindi", monospace }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<H2 CLASS="western"><A NAME="__DdeLink__10_688433337"></A>XML format
for schema description</H2>
<P>See also files <TT CLASS="western">*.xml</TT> in the <TT CLASS="western">examples</TT>
folder.</P>
<P>The root element of the schema description document is <TT CLASS="western">&lt;schema&gt;</TT>.
It can have nested elements <TT CLASS="western">&lt;table&gt;</TT>
and <TT CLASS="western">&lt;relation&gt;</TT>.</P>
<P>To describe an entity (a table) and to map it to a class use
<TT CLASS="western">&lt;table&gt;</TT> element. In turn, it contains
one or more nested <TT CLASS="western">&lt;column&gt;</TT> elemens to
describe a single table column and to map it to a class member. The
following attributes for <TT CLASS="western">&lt;table&gt;</TT>
element are accepted:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">name</TT> –
	The name of table, provide as in SQL. This is a <EM>required</EM>
	attribute.</P>
	<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">class</TT> –
	The name of class to map the table to, if not set no domain class
	will be created for the table.</P>
	<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">sequence</TT>
	– To be able to generate unique IDs for newly inserted records
	some databases (Oracle, Postgres) utilize sequences or generators,
	some others (e.g. MySQL) – don't. You can safely set here the name
	of sequence that will be used to generate IDs if the underlying
	database supports this; for other databases this will mean that the
	value for the primary key in the table is autogenerated on
	insertion.</P>
	<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">autoinc</TT> –
	Like the previous, but only suitable for databases with no sequences
	or generators, like MySQL and SQLite.</P>
	<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">xml-name</TT>
	– The name will be used when a persistent object is serialized in
	form of XML (look at <TT CLASS="western">include/yb/orm/xmlizer.h</TT>),
	if not given the table's name is used, translated to lower case,
	where all<TT CLASS="western">'_'</TT> are replaced with <TT CLASS="western">'-'</TT>.</P>
</UL>
<P>Element <TT CLASS="western">&lt;column&gt;</TT> used to describe a
column/class member may have the following attributes:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">name</TT> –
	The name of column, provide as in SQL. This is a <EM>required</EM>
	attribute.</P>
	<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">property</TT>
	– The name of class member if it must differ from column's name.</P>
	<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">type</TT> –
	The datatype of the column. This is a <EM>required</EM> attribute.
	YB.ORM has it's own types that are mapped to SQL types and to C++
	types. As of now, the following types are supported:</P>
	<UL>
		<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">string</TT> –
		String of characters.</P>
		<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">integer</TT>
		– 32 bit signed integer.</P>
		<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">longint</TT>
		– 64 bit signed integer, suitable for ID generation.</P>
		<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">decimal</TT>
		– Precise decimal number with fraction part, suitable for storing
		money values, etc.</P>
		<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">float</TT> –
		Double precision floating point number.</P>
		<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">datetime</TT>
		– Timestamp with date and time parts.</P>
	</UL>
	<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">size</TT> –
	Maximum length of the value for that column, applicable to <TT CLASS="western">string</TT>
	type only.</P>
	<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">null</TT> –
	The flag denotes the column that may be assigned <TT CLASS="western">NULL</TT>,
	the possible values are <TT CLASS="western">&quot;true&quot;</TT>
	and <TT CLASS="western">&quot;false&quot;</TT>. By default it's
	<TT CLASS="western">&quot;true&quot;</TT> unless the column is
	marked to be a (part of) primary key.</P>
	<LI><P><TT CLASS="western">default</TT> – The option set default
	value for the column. This attribute may contain a constant of type,
	specified by the <TT CLASS="western">&quot;type&quot;</TT>
	attribute, or a special value <TT CLASS="western">&quot;sysdate&quot;</TT>
	for <TT CLASS="western">&quot;datetime&quot;</TT> type to insert the
	current date and time.</P>
	<LI><P><TT CLASS="western">xml-name</TT> – The name will be used
	when a persistent object is serialized in form of XML (look at
	<TT CLASS="western">include/yb/orm/xmlizer.h</TT>), if not given the
	column's name is used, translated to lower case, where all<TT CLASS="western">'_'</TT>
	are replaced with <TT CLASS="western">'-'</TT>. To exclude a column
	from the output set this field to special value <TT CLASS="western">'!'</TT>.</P>
</UL>
<P>The following nested elements may be found inside a <TT CLASS="western">&lt;column&gt;</TT>
element, they describe additional constraints:</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">&lt;read-only&gt;</TT>
	– The column may only be assigned a value on selection from
	database or on object creation, any subsequent updates will produce
	an error.</P>
	<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">&lt;primary-key&gt;</TT>
	– Mark the column as a primary key or as a part of compound
	primary key.</P>
	<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">&lt;foreign-key&gt;</TT>
	– The column refers to another table and column, this is also
	known as foreign key constraint. To describe the reference this
	element is given the following attributes:</P>
    <UL>
        <LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">table</TT> –
        The name of the table the column refers to. This is a <EM>required</EM>
        attribute.</P>
        <LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">key</TT> –
        The column name in the referenced table. This may be omitted if the
        column referenced is the primary key.</P>
    </UL>
</UL>
<P>To describe a relationship between two entities and their
correspoding domain classes, there is a top-level element <TT CLASS="western">&lt;relation&gt;</TT>.
The contents of this element depends on a type of relationship
specified. The required attribute <TT CLASS="western">&quot;type&quot;</TT>
can be <TT CLASS="western">&quot;one-to-many&quot;</TT>. Other kinds
of relationship (<TT CLASS="western">&quot;many-to-many&quot;</TT>,
<TT CLASS="western">&quot;parent-to-child&quot;</TT>) are yet to be
implemented. The optional attribute <TT CLASS="western">&quot;cascade&quot;</TT>
defines what action to take for the slave records on attempt to
delete the master record. Possible actions are: <TT CLASS="western">&quot;restrict&quot;</TT>,
<TT CLASS="western">&quot;set-null&quot;</TT>, <TT CLASS="western">&quot;delete&quot;</TT>.
To use <TT CLASS="western">&quot;set-null&quot;</TT> the dependent
table must have its foreign key field nullable: <TT CLASS="western">null=&quot;true&quot;</TT>.
</P>
<UL>
	<UL>
		<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">&quot;one-to-many&quot;</TT>
		- this kind of relationship assumes two nested elements. 
		</P>
		<UL>
			<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">&lt;one&gt;</TT>
			- class for the master table, its attributes: 
			</P>
			<UL>
				<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">class</TT>
				- (required) class name, mapped to the master table; 
				</P>
				<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">property</TT>
				- (optional) property name, created to reference typically
				multiple dependent objects; 
				</P>
				<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">use-list</TT>
				- (optional) if there is a property at master object, referring
				slave objects, then if this attribute set to <TT CLASS="western">false</TT>,
				the property looks like a single object reference rather than a
				list; useful for modeling relations one-to-one. 
				</P>
			</UL>
			<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">&lt;many&gt;</TT>
			- for the dependent class, possible attributes: 
			</P>
			<UL>
				<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">class</TT>
				- (required) class name, mapped to the dependent table; 
				</P>
				<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">property</TT>
				- (optional) property name, created to reference single master
				object; 
				</P>
				<LI><P STYLE="margin-bottom: 0cm"><TT CLASS="western">key</TT> -
				(optional) specifies what column to use as a foreign key, useful
				if there's more than one relation between two tables; 
				</P>
				<LI><P><TT CLASS="western">order-by</TT> - (optional) it contains
				SQL expression to <TT CLASS="western">ORDER BY</TT> clause to
				determine the order in which dependent objects will appear when
				accessing the relationship object, e. g. when walking through
				list-property at master object. 
				</P>
			</UL>
		</UL>
	</UL>
</UL>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
</BODY>
</HTML>
